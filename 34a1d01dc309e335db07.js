/*! For license information please see 34a1d01dc309e335db07.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),s=new E(n||[]);return a(i,"_invoke",{value:R(e,r,s)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p="suspendedStart",f="suspendedYield",h="executing",m="completed",y={};function g(){}function x(){}function v(){}var _={};u(_,i,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(P([])));w&&w!==r&&n.call(w,i)&&(_=w);var T=v.prototype=g.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function r(a,o,i,s){var c=d(e[a],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function R(t,r,n){var a=p;return function(o,i){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=F(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:f,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function F(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,F(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(_typeof(t)+" is not iterable")}return x.prototype=v,a(T,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:x,configurable:!0}),x.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},S(I.prototype),u(I.prototype,s,(function(){return this})),t.AsyncIterator=I,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new I(l(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(T),u(T,c,"Generator"),u(T,i,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;k(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function asyncGeneratorStep(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){asyncGeneratorStep(o,n,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,n,a,i,s,"throw",e)}i(void 0)}))}}Office.onReady((function(e){e.host===Office.HostType.PowerPoint&&monitorSlideIndexChanges()}));import{initializeApp}from"firebase/app";import{getFirestore,collection,addDoc,deleteDoc,doc,setDoc}from"firebase/firestore";import pollText from"./polltext.js";var firebaseConfig={apiKey:"AIzaSyCdXTSmHfxpTLCu98YkR5c-rsYhCy8APn0",authDomain:"attendance-96d8b.firebaseapp.com",projectId:"attendance-96d8b",storageBucket:"attendance-96d8b.appspot.com",messagingSenderId:"887702285650",appId:"1:887702285650:web:616233e13ea5df50c3de8b",measurementId:"G-0YEVE2ZPYS"},app=initializeApp(firebaseConfig),db=getFirestore(app),firebaseDocId=null,fibrebaseTeacherId=null;function sendToFirebase(e){return _sendToFirebase.apply(this,arguments)}function _sendToFirebase(){return(_sendToFirebase=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("updaged and initalized"),e.prev=1,fibrebaseTeacherId=t.substring(0,t.indexOf("&")).trim(),e.next=5,setDoc(doc(db,"slides",fibrebaseTeacherId),{text:t});case 5:return e.sent,e.next=8,addDoc(collection(db,"slides",fibrebaseTeacherId,"questions"),{text:t});case 8:r=e.sent,console.log("Document written with ID: ",r.id),console.log("gfirebaseDocID "),firebaseDocId=r.id,console.log("gfirebaseDocID ",firebaseDocId),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("Error adding document: ",e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}window.addEventListener("message",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"https://attendance-96d8b.web.app"==t.origin&&(console.error("message arrived: ",t.data.payload),"MC"==t.data.type?addNumberOfStudnets(t.data.payload,!0):"WC"==t.data.type?addNumberOfStudnets(t.data.payload,!1):insertWhiteTextWithShape(t.data.payload));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var iframe=document.querySelector("iframe");function sendDataToWebApp(e){return _sendDataToWebApp.apply(this,arguments)}function _sendDataToWebApp(){return(_sendDataToWebApp=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:iframe.contentWindow.postMessage({type:"REQUEST_DATA",payload:t},"https://attendance-96d8b.web.app"),console.log("sent this payload: ",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function deleteFromFirebase(e,t){return _deleteFromFirebase.apply(this,arguments)}function _deleteFromFirebase(){return(_deleteFromFirebase=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Deleting from Firebase:",t),e.prev=1,e.next=4,deleteDoc(doc(db,"slides",r,"questions",t));case 4:console.log("Document deleted with ID: ",t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Error deleting document: ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function monitorSlideIndexChanges(){var e=null,t=!1;function r(){return n.apply(this,arguments)}function n(){return(n=_asyncToGenerator(_regeneratorRuntime().mark((function n(){var a;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return");case 2:return t=!0,n.prev=3,n.next=6,getSelectedSlideIndex();case 6:if(a=n.sent,null===e||a===e){n.next=17;break}if(null==firebaseDocId||null==fibrebaseTeacherId){n.next=15;break}return console.log("Deleting previous Firebase document..."),n.next=12,deleteFromFirebase(firebaseDocId,fibrebaseTeacherId);case 12:deleteAnswerCount(e),firebaseDocId=null,fibrebaseTeacherId=null;case 15:console.log("hello"),readTexts();case 17:e=a,n.next=23;break;case 20:n.prev=20,n.t0=n.catch(3),console.error("Error checking slide index:",n.t0);case 23:return n.prev=23,t=!1,setTimeout(r,500),n.finish(23);case 27:case"end":return n.stop()}}),n,null,[[3,20,23,27]])})))).apply(this,arguments)}r()}function deleteAnswerCount(e){return _deleteAnswerCount.apply(this,arguments)}function _deleteAnswerCount(){return _deleteAnswerCount=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(r){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=r.presentation.slides.getItemAt(t)).shapes.load("textFrame/textRange/text, textFrame/textRange/hasText, name"),e.next=4,r.sync();case 4:n.shapes.items.forEach((function(e){console.log("the title is",e.name),"answers_received"===e.name&&e.delete()}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error recieved",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_deleteAnswerCount.apply(this,arguments)}function readTexts(){return _readTexts.apply(this,arguments)}function _readTexts(){return _readTexts=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getSelectedSlideIndex();case 2:return t=e.sent,r=t-1,e.next=6,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.presentation.slides.getItemAt(r).shapes).load(),n.load("textFrame/textRange/text, textFrame/textRange/hasText"),e.next=5,t.sync();case 5:return a="",n.items.forEach((function(e){try{a+=e.textFrame.textRange.text+" "}catch(e){console.log("Error:",e)}})),console.log("Total text:",a),sendDataToWebApp(a),e.next=11,t.sync();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)}))),_readTexts.apply(this,arguments)}function getSelectedSlideIndex(){return _getSelectedSlideIndex.apply(this,arguments)}function _getSelectedSlideIndex(){return(_getSelectedSlideIndex=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){Office.context.document.getSelectedDataAsync(Office.CoercionType.SlideRange,(function(r){r.status===Office.AsyncResultStatus.Failed?t(new Error(r.error.message)):e(r.value.slides[0].index)}))}));case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),console.error("Error getting selected slide index:",e.t0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function insertText(){return _insertText.apply(this,arguments)}function _insertText(){return(_insertText=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insertPollSlide(pollText,1);case 2:goToNextSlide();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function insertWhiteTextWithShape(e){return _insertWhiteTextWithShape.apply(this,arguments)}function _insertWhiteTextWithShape(){return _insertWhiteTextWithShape=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(r){var n,a,o,i,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getSelectedSlideIndex();case 2:return n=e.sent,a=n-1,o=r.presentation.slides.getItemAt(a).load("id"),e.next=7,r.sync();case 7:return i={formatting:"KeepSourceFormatting",targetSlideId:o.id},r.presentation.insertSlidesFromBase64(pollText,i),e.next=11,r.sync();case 11:return s=r.presentation.slides.getItemAt(n),goToNextSlide(),addTeacherIdentifier(s,t.substring(0,t.indexOf(" "))),addPossibleAnswers(s,t.substring(t.indexOf(" ")+1)),e.next=17,r.sync();case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_insertWhiteTextWithShape.apply(this,arguments)}function insertAnswersSlides(){return _insertAnswersSlides.apply(this,arguments)}function _insertAnswersSlides(){return _insertAnswersSlides=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,a,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getSelectedSlideIndex();case 2:return r=e.sent,n=r-1,a=t.presentation.slides.getItemAt(n).load("id"),e.next=7,t.sync();case 7:return o={formatting:"KeepSourceFormatting",targetSlideId:a.id},t.presentation.insertSlidesFromBase64(pollText,o),e.next=11,t.sync();case 11:return t.presentation.slides.getItemAt(r),e.next=14,t.sync();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error recieved",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_insertAnswersSlides.apply(this,arguments)}function addPossibleAnswers(e,t){var r=e.shapes.addTextBox(t,{left:50,top:50,width:650,height:200}).textFrame;r.verticalAlignment=PowerPoint.TextVerticalAlignment.top;var n=r.textRange;n.font.size=24;var a=n.getSubstring(0,t.indexOf("\n"));a.font.bold=!0,a.font.size=30}function addTeacherIdentifier(e,t){e.shapes.addTextBox(t,{left:10,top:10,width:200,height:50}).textFrame.textRange.font.color="#FFFFFF";var r=e.shapes.addGeometricShape(PowerPoint.GeometricShapeType.rectangle,{left:10,top:10,width:200,height:50});r.fill.setSolidColor("#FFFFFF"),r.lineFormat.visible=!1}function addNumberOfStudnets(e,t){return _addNumberOfStudnets.apply(this,arguments)}function _addNumberOfStudnets(){return _addNumberOfStudnets=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var a,o,i,s,c,u,l,d,p;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getSelectedSlideIndex();case 2:return a=e.sent,o=a-1,(i=n.presentation.slides.getItemAt(o).load("id")).shapes.load("textFrame/textRange/text, textFrame/textRange/hasText, name"),e.next=8,n.sync();case 8:if(s="",i.shapes.items.forEach((function(e){try{s+=e.textFrame.textRange.text+" "}catch(e){console.log("Error:",e)}})),s.includes("Poll:")){e.next=13;break}return console.log("didnt add the poll"),e.abrupt("return");case 13:if(c=null,i.shapes.items.forEach((function(e){console.log("the title is",e.name),"answers_received"===e.name&&(c=e)})),u=t.split("@").map((function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],n=t[1];return{label:r,count:parseInt(n,10)}})),l=u.reduce((function(e,t){return e+t.count}),0),null==c){e.next=23;break}console.log("Updating text in existing shape"),c.textFrame.textRange.text=l.toString(),r&&createBarChartFromInput(a,t),e.next=38;break;case 23:if(console.log("Creating new shape as no existing shape matched"),(d=n.presentation).load("slideWidth, slideHeight"),n.sync().then((function(){console.log("Slide Width: "+d.slideWidth),console.log("Slide Height: "+d.slideHeight)})),(p=i.shapes.addTextBox(l.toString(),{left:50,top:450,width:200,height:50})).name="answers_received",p.textFrame.textRange,!r){e.next=36;break}return e.next=33,insertAnswersSlides();case 33:createBarChartFromInput(a,t),e.next=36;break;case 36:return e.next=38,n.sync();case 38:return e.next=40,n.sync();case 40:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error recieved",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_addNumberOfStudnets.apply(this,arguments)}function createBarChartFromInput(e,t){return _createBarChartFromInput.apply(this,arguments)}function _createBarChartFromInput(){return _createBarChartFromInput=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var a,o,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=n.presentation.slides.getItemAt(t)).shapes.load("textFrame/textRange/text, textFrame/textRange/hasText, name"),e.next=4,n.sync();case 4:return a.shapes.items.forEach((function(e){console.log("the title is",e.name),"answername"!==e.name&&"bargraph"!==e.name||e.delete()})),o=r.split("@").map((function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],n=t[1];return{label:r,count:parseInt(n,10)}})),i=50,o.forEach((function(e,t){var r=e.label,n=e.count;a.shapes.addTextBox(r+" ["+n.toString()+"]",{left:50,top:i,width:400,height:100}).name="answername";var s=n/Math.max.apply(Math,_toConsumableArray(o.map((function(e){return e.count}))))*500;i+=45;var c=a.shapes.addGeometricShape(PowerPoint.GeometricShapeType.rectangle);c.left=70,c.top=i,c.width=s,c.height=30,c.fill.setSolidColor("#008080"),c.lineFormat.visible=!1,c.name="bargraph",i+=45})),e.next=14,n.sync();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error recieved",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_createBarChartFromInput.apply(this,arguments)}function createWordCloudFromInput(e,t){return _createWordCloudFromInput.apply(this,arguments)}function _createWordCloudFromInput(){return _createWordCloudFromInput=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var a,o,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=n.presentation.slides.getItemAt(t)).shapes.load("textFrame/textRange/text, textFrame/textRange/hasText, name"),e.next=4,n.sync();case 4:return a.shapes.items.forEach((function(e){"answername"!==e.name&&"wordcloud"!==e.name||e.delete()})),o=r.split("@").map((function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],n=t[1];return{label:r,count:parseInt(n,10)}})),i=Math.max.apply(Math,_toConsumableArray(o.map((function(e){return e.count})))),o.forEach((function(e,t){var r=e.label,n=20+80*e.count/i,o=600*Math.random()+50,s=350*Math.random()+50,c=a.shapes.addTextBox(r,{left:o,top:s,width:300,height:100});c.textFrame.textRange.font.size=n,c.textFrame.textRange.font.color="#008080",c.name="wordcloud",console.log("Added word: ".concat(r," with font size ").concat(n))})),e.next=10,n.sync();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error received: ",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_createWordCloudFromInput.apply(this,arguments)}function addQuestionText(e,t){var r=e.shapes.addTextBox(t,{left:50,top:50,width:400,height:100}).textFrame;r.verticalAlignment=PowerPoint.TextVerticalAlignment.middle;var n=r.textRange;n.font.bold=!0,n.font.size=45}function addSlideWithMatchingLayout(){return _addSlideWithMatchingLayout.apply(this,arguments)}function _addSlideWithMatchingLayout(){return _addSlideWithMatchingLayout=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getSelectedSlideIndex();case 2:return r=e.sent,n=r-1,a=t.presentation.slides.getItemAt(n).load("slideMaster/id, layout/id"),e.next=7,t.sync();case 7:return console.log(a.layout.id),t.presentation.slides.add({slideMasterId:a.slideMaster.id,layoutId:a.layout.id}),e.next=11,t.sync();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_addSlideWithMatchingLayout.apply(this,arguments)}function insertPollSlide(e,t){return _insertPollSlide.apply(this,arguments)}function _insertPollSlide(){return _insertPollSlide=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,PowerPoint.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var a,o,i,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getSelectedSlideIndex();case 2:return a=e.sent,o=a-r,i=n.presentation.slides.getItemAt(o).load("id"),e.next=7,n.sync();case 7:return s={formatting:"KeepSourceFormatting",targetSlideId:i.id},n.presentation.insertSlidesFromBase64(t,s),e.next=11,n.sync();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_insertPollSlide.apply(this,arguments)}function goToNextSlide(){Office.context.document.goToByIdAsync(Office.Index.Next,Office.GoToType.Index,(function(e){e.status===Office.AsyncResultStatus.Failed&&setMessage("Error: "+e.error.message)}))}function clearMessage(e){return _clearMessage.apply(this,arguments)}function _clearMessage(){return(_clearMessage=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("message").innerText="",e.next=3,t();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function setMessage(e){document.getElementById("message").innerText=e}function tryCatch(e){return _tryCatch.apply(this,arguments)}function _tryCatch(){return(_tryCatch=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,document.getElementById("message").innerText="",e.next=4,t();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),setMessage("Error: "+e.t0.toString());case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}